<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>genis.ai - AI Presentation Generator</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="/css/styles.css?v=<?php echo time(); ?>">
</head>
<body>
    <div class="container">
        <!-- Floating Free Badge -->
        <div class="floating-badge">
            <span class="badge-icon">🎁</span>
            <span class="badge-text">100% FREE</span>
        </div>
        
        <!-- Product Hunt Badge -->
        <div class="floating-product-hunt">
            <a href="https://www.producthunt.com/products/genis-ai?embed=true&utm_source=badge-featured&utm_medium=badge&utm_source=badge-genis&#0045;ai" target="_blank">
                <img src="https://api.producthunt.com/widgets/embed-image/v1/featured.svg?post_id=1030870&theme=light&t=1761434413944" alt="GENIS&#0046;AI - Transform&#0032;Your&#0032;Ideas&#0032;into&#0032;Stunning&#0032;Presentations&#0032;with&#0032;AI | Product Hunt" style="width: 250px; height: 54px;" width="250" height="54" />
            </a>
        </div>
        
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1 class="brand-name">GENIS.AI</h1>
            </div>
            <div class="header-right">
                <div class="header-top-row">
                    <p class="brand-tagline">Transform Your Ideas into Stunning Presentations with AI</p>
                    <a class="github-button" href="https://github.com/skunpoj/pptx" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="octicon-star" data-size="large" aria-label="Star skunpoj/pptx on GitHub">Star</a>
                </div>
                <div class="header-features">
                    <span class="header-feature">🤖 AI-Powered</span>
                    <span class="header-feature">📊 Native Charts</span>
                    <span class="header-feature">🎨 8+ Themes</span>
                    <span class="header-feature">🔗 Share Links</span>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Left Panel: Content Input -->
            <div class="card">
                <h2>📝 Your Content</h2>
                
                <!-- Main Content Editor -->
                <div class="content-editor-section">
                    <p style="margin: 0 0 1rem 0; color: #555; font-size: 0.95rem;">Enter or paste your detailed presentation content here, then generate preview</p>
                    
                    <textarea id="textInput" class="content-textarea" placeholder="Type or paste your detailed presentation content here...

Example:
Company Overview
- Founded in 2020 with mission to innovate
- Serving 500+ clients globally  
- Revenue growth of 150% year-over-year

Our Products
- AI-powered analytics platform
- Real-time dashboard
- Custom reporting tools"></textarea>
                </div>
                
                <!-- Quick Examples -->
                <div class="quick-examples" style="margin-top: 1rem;">
                    <p class="examples-label">📚 Quick Start Examples:</p>
                    <div class="examples-grid">
                        <button class="btn-secondary" onclick="window.loadExampleByCategory('tech')">💻 Tech</button>
                        <button class="btn-secondary" onclick="window.loadExampleByCategory('business')">💼 Business</button>
                        <button class="btn-secondary" onclick="window.loadExampleByCategory('education')">📚 Education</button>
                        <button class="btn-secondary" onclick="window.loadExampleByCategory('health')">🏥 Healthcare</button>
                        <button class="btn-secondary" onclick="window.loadExampleByCategory('marketing')">📈 Marketing</button>
                        <button class="btn-secondary" onclick="window.loadExampleByCategory('environment')">🌍 Environment</button>
                    </div>
                </div>
                
                <!-- Preview Button -->
                <button class="btn-primary btn-full btn-large" onclick="window.generatePreview()" id="previewBtn" style="margin-top: 1rem;">
                    👁️ Generate Preview
                </button>
            </div>

                <!-- Right Panel: Preview -->
            <div class="card preview-container">
                <h2>👁️ Slide Preview</h2>
                
                <!-- Tab Navigation -->
                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; border-bottom: 2px solid #ddd;">
                    <button class="gallery-tab-btn active" id="slidesTabBtn" onclick="window.showSlidesPreview()">
                        📄 Slides
                    </button>
                    <button class="gallery-tab-btn" id="galleryTabBtn" onclick="window.showImageGallery()">
                        🖼️ Image Gallery
                    </button>
                    <button class="btn-secondary" onclick="window.generateImagesForSlides()" style="margin-left: auto; padding: 0.5rem 1rem; font-size: 0.85rem;">
                        🎨 Generate Images
                    </button>
                </div>
                
                <!-- Slides Preview Container -->
                <div class="preview" id="preview" style="overflow-y: auto !important; flex: 1 1 auto !important; min-height: 0 !important;"></div>
                
                <!-- Image Gallery Container -->
                <div id="imageGalleryContainer" style="display: none; overflow-y: auto !important; flex: 1 1 auto !important; min-height: 0 !important;"></div>
            </div>
        </div>

        <!-- Status Notification -->
        <div id="status"></div>

        <!-- Action Buttons Section -->
        <div id="actionButtonsContainer" style="max-width: 1400px; margin: 0 auto; padding: 0 1rem;">
            <!-- Slide Modification Section (appears after preview) -->
            <div id="modificationSection" style="display: none; margin-bottom: 1rem;">
                <div class="card" style="background: #fff8e1; border: 2px solid #ffc107; padding: 1rem;">
                    <strong style="color: #f57c00; display: block; margin-bottom: 0.5rem; font-size: 1.1rem;">✏️ Modify Slides with AI</strong>
                    <textarea id="modificationPrompt" 
                              placeholder="Example: 'Change slide 3 title to...' or 'Add a bullet point to slide 2 about...' or 'Remove slide 5'"
                              style="width: 100%; height: 70px; padding: 0.75rem; border: 1px solid #ffc107; border-radius: 8px; font-size: 0.9rem; resize: vertical;"></textarea>
                    <button class="btn-secondary btn-full" onclick="window.modifySlides()" id="modifyBtn" style="margin-top: 0.75rem; font-size: 1rem; padding: 0.75rem;">
                        🔄 Apply AI Modifications
                    </button>
                </div>
            </div>
            
            <!-- Generate PowerPoint Button (appears after preview) -->
            <div id="generatePptSection" style="display: none; margin-bottom: 1rem;">
                <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; padding: 1.5rem; text-align: center;">
                    <button class="btn-generate btn-full" onclick="window.generatePresentation()" id="generateBtn" style="background: white; color: #667eea; font-size: 1.2rem; font-weight: 700; padding: 1rem;">
                        ✨ Generate PowerPoint Presentation
                    </button>
                    <p style="text-align: center; font-size: 0.9rem; color: white; margin-top: 0.75rem; opacity: 0.95;">
                        Download PPTX, view slides online, auto-convert to PDF, or create shareable link
                    </p>
                </div>
            </div>
        </div>

        <!-- AI IDEA GENERATOR & THEME SELECTOR - Below modify slides section, above settings -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1rem;">
            <!-- Left: AI Idea Generator -->
            <div class="card idea-generator-section" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); border: 3px solid #ff9a56;">
                <h3 style="margin: 0 0 0.5rem 0; color: #d35400; font-size: 1.3rem;">💡 AI Idea Generator</h3>
                <p class="section-description" style="color: #555; margin-bottom: 1rem;">Don't have content yet? Let AI expand your simple idea into detailed presentation content</p>
                
                <!-- Idea Input -->
                <textarea id="ideaInput" class="idea-input" placeholder="Describe your presentation idea...">Create a quarterly business review presentation for Q4 2024 showing sales performance, market trends, and strategic initiatives for the executive team.</textarea>
                
                <!-- Expand Idea Button - Right after textarea -->
                <button class="btn-primary btn-full" onclick="window.generateFromPrompt()" id="promptBtn" style="margin-top: 1rem;">
                    🚀 Expand Idea into Full Content
                </button>
                <p class="helper-text" style="margin-top: 0.5rem;">This creates detailed text content that you can edit above before generating slides</p>
                
                <!-- File Upload -->
                <div class="file-upload-section" style="margin-top: 1.5rem;">
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 1rem; align-items: end; margin-bottom: 0.75rem;">
                        <div>
                    <label class="file-label">📎 Or upload files (PDF, DOC, TXT, PPT):</label>
                    <input type="file" id="fileUpload" multiple accept=".txt,.pdf,.doc,.docx,.md,.pptx" class="file-input">
                        </div>
                        <div>
                            <label class="option-label">Number of slides:</label>
                            <input type="number" id="numSlides" value="6" min="3" max="20" class="number-input">
                        </div>
                    </div>
                    
                    <!-- Extract Colors Checkbox -->
                    <label class="checkbox-label checkbox-blue">
                        <input type="checkbox" id="extractColors" checked>
                        <span>
                            <strong>🎨 Extract color theme from uploaded files</strong>
                            <span class="checkbox-desc">File content will be incorporated and used together with your idea prompt to create the presentation. AI also suggests color themes based on file names/types (e.g., finance → blue, healthcare → teal)</span>
                        </span>
                    </label>
                    
                    <!-- Use as Template Checkbox -->
                    <label class="checkbox-label checkbox-orange">
                        <input type="checkbox" id="useAsTemplate" checked>
                        <span>
                            <strong>📄 Use uploaded PPTX as template/base</strong>
                            <span class="checkbox-desc">Uses uploaded PowerPoint file as template - preserves formatting, modifies content, or adds new slides</span>
                        </span>
                    </label>
                    
                    <!-- AI Image Generation Checkbox -->
                    <label class="checkbox-label checkbox-green">
                        <input type="checkbox" id="generateImages" checked>
                        <span>
                            <strong>📸 Include AI-generated image suggestions in content</strong>
                            <span class="checkbox-desc">AI will include image descriptions in the generated content (descriptions only, not actual images)</span>
                        </span>
                        </label>
                    </div>
                </div>

            <!-- Right: Color Theme & Output Format -->
            <div class="card" id="themeSelector" style="background: #f0fff4; border: 2px solid #82C341;">
                <div class="theme-header">
                    <h3>🎨 Choose Color Theme</h3>
                    <span id="suggestedBadge" class="suggested-badge" style="display: none;">AI Suggested</span>
                </div>
                <p class="theme-description">Select a color palette for your presentation (AI may suggest one based on your content)</p>
                <div id="themeGrid" class="theme-grid"></div>
                
                <!-- Output File Type Selection -->
                <label style="display: block; font-weight: 700; color: #2d8659; margin: 1.5rem 0 0.5rem 0;">📄 Output File Type:</label>
                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: background 0.2s;" class="file-type-option">
                            <input type="radio" name="outputType" value="pptx-direct" checked onchange="window.selectOutputType('pptx-direct')" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-weight: 600; color: #333; font-size: 0.85rem;">📊 PPTX Direct</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: background 0.2s;" class="file-type-option">
                            <input type="radio" name="outputType" value="pptx-skill" onchange="window.selectOutputType('pptx-skill')" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-weight: 600; color: #333; font-size: 0.85rem;">📊 PPTX Skill</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: background 0.2s;" class="file-type-option">
                            <input type="radio" name="outputType" value="docx" onchange="window.selectOutputType('docx')" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-weight: 600; color: #333; font-size: 0.85rem;">📝 Word</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: background 0.2s;" class="file-type-option">
                            <input type="radio" name="outputType" value="pdf" onchange="window.selectOutputType('pdf')" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-weight: 600; color: #333; font-size: 0.85rem;">📄 PDF</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: background 0.2s;" class="file-type-option">
                            <input type="radio" name="outputType" value="xlsx" onchange="window.selectOutputType('xlsx')" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-weight: 600; color: #333; font-size: 0.85rem;">📈 Excel</span>
                        </label>
                    </div>
                <p style="margin: 0.5rem 0 0 0; font-size: 0.8rem; color: #666;">Select the output format for your generated document</p>
            </div>
        </div>

        <!-- Settings Card -->
        <div class="card settings-card">
            <h2 onclick="window.toggleSettingsSection()" class="collapsible-header">
                <span>⚙️ Advanced Configuration</span>
                <span id="settingsToggleIcon" class="toggle-icon">▼</span>
            </h2>
            
            <div id="settingsSectionContainer" style="display: block;">
                <div class="settings-tabs">
                    <button class="settings-tab active" onclick="window.switchSettingsTab('api')" id="tab-api">
                        🔑 API Keys
                    </button>
                    <button class="settings-tab" onclick="window.switchSettingsTab('prompts')" id="tab-prompts">
                        📝 AI Prompts
                    </button>
                </div>
                
                <!-- API Settings Content -->
                <div id="apiSettingsContent">
                    <h3 style="margin-top: 1rem;">🔑 API Configuration</h3>
                
                    <div id="apiSectionContainer" class="api-section-container">
                    <!-- Provider Selection for Content Generation -->
                    <div class="provider-selection">
                        <h3>📝 Content Generation Provider</h3>
                        <p style="font-size: 0.85rem; color: #666; margin-bottom: 0.75rem;">Select which AI to use for writing presentation content and slide structure</p>
                        <div class="provider-buttons">
                            <button class="provider-btn active" onclick="window.selectProvider('anthropic')" id="provider-anthropic">Anthropic</button>
                            <button class="provider-btn" onclick="window.selectProvider('openai')" id="provider-openai">OpenAI</button>
                            <button class="provider-btn" onclick="window.selectProvider('gemini')" id="provider-gemini">Gemini</button>
                            <button class="provider-btn" onclick="window.selectProvider('openrouter')" id="provider-openrouter">OpenRouter</button>
                        </div>
                    </div>
                    
                    <!-- Provider Selection for Image Generation -->
                    <div class="provider-selection" style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #e0e0e0;">
                        <h3>🎨 Image Generation Provider</h3>
                        <p style="font-size: 0.85rem; color: #666; margin-bottom: 0.75rem;">Select which AI to use for creating actual images from descriptions (optional)</p>
                        <div class="provider-buttons">
                            <button class="provider-btn-img active" onclick="window.selectImageProvider('huggingface')" id="img-provider-huggingface">
                                🤗 Hugging Face
                                <span style="display: block; font-size: 0.7rem; opacity: 0.8;">Free API • Default</span>
                            </button>
                            <button class="provider-btn-img" onclick="window.selectImageProvider('dalle')" id="img-provider-dalle">DALL-E 3</button>
                            <button class="provider-btn-img" onclick="window.selectImageProvider('stability')" id="img-provider-stability">Stability AI</button>
                            <button class="provider-btn-img" onclick="window.selectImageProvider('gemini')" id="img-provider-gemini" disabled style="opacity: 0.5; cursor: not-allowed; position: relative;">
                                Gemini Imagen
                                <span style="display: block; font-size: 0.65rem; color: #e74c3c; font-weight: 700;">⚠️ Not Available</span>
                            </button>
                        </div>
                        <p style="font-size: 0.75rem; color: #2ecc71; margin-top: 0.5rem; font-weight: 600;">🎁 Hugging Face: FREE API access to Stable Diffusion & FLUX models!</p>
                        <p style="font-size: 0.75rem; color: #888; margin-top: 0.25rem; font-style: italic;">💡 Get free API key at <a href="https://huggingface.co/settings/tokens" target="_blank" style="color: #667eea;">huggingface.co/settings/tokens</a></p>
                        <div id="imageProviderHint" style="margin-top: 0.75rem; padding: 0.5rem; background: #f0f4ff; border-left: 3px solid #667eea; border-radius: 4px; font-size: 0.8rem; color: #555;">
                            💡 <strong>Currently selected:</strong> <span id="currentImageProviderName">Hugging Face</span>
                            <br>
                            <span style="font-size: 0.75rem; color: #777;">The API key input section below will update when you select a different provider.</span>
                        </div>
                    </div>

                    <!-- Hugging Face Section (for image generation) - SHOWN BY DEFAULT & FIRST -->
                    <div class="api-section provider-section" id="section-huggingface" style="margin-top: 1.5rem; border-top: 3px solid #ff9800; padding-top: 1.5rem;">
                        <h3>🤗 Hugging Face API (for Image Generation)</h3>
                        <div class="info-box" style="background: linear-gradient(135deg, #fff8e1 0%, #ffe0b2 100%); border-left: 4px solid #ff9800;">
                            <strong style="color: #e65100;">🎁 FREE Image Generation!</strong>
                            <p style="margin-top: 0.5rem; color: #666;">Hugging Face offers <strong>FREE API access</strong> to powerful models like Stable Diffusion XL and FLUX.1</p>
                            <strong style="margin-top: 1rem; display: block;">To get your FREE API key:</strong>
                            <ol>
                                <li>Go to <a href="https://huggingface.co/join" target="_blank">huggingface.co/join</a> (create account)</li>
                                <li>Navigate to <a href="https://huggingface.co/settings/tokens" target="_blank">Settings → Access Tokens</a></li>
                                <li>Click "New token" or "Create new token"</li>
                                <li>Give it a name (e.g., "GENIS.AI") and select "Read" access</li>
                                <li>Copy your token (starts with <code>hf_...</code>)</li>
                            </ol>
                            <p style="margin-top: 0.5rem; color: #666;">💡 <strong>Note:</strong> Hugging Face is the default and recommended option for FREE unlimited image generation!</p>
                        </div>
                        <form autocomplete="off" onsubmit="return false;">
                            <div class="input-group">
                                <input type="text" 
                                       id="apiKey-huggingface" 
                                       placeholder="hf_..."
                                       autocomplete="off"
                                       data-form-type="other"
                                       data-lpignore="true"
                                       name="not-a-password"
                                       spellcheck="false"
                                       style="font-family: monospace; letter-spacing: 0.5px;">
                                <button class="btn-primary" onclick="window.saveApiKey('huggingface'); return false;" type="button">Save Key</button>
                            </div>
                        </form>
                    </div>

                    <!-- Anthropic Section -->
                    <div class="api-section provider-section" id="section-anthropic">
                        <h3>Anthropic Claude API</h3>
                        <div class="info-box">
                            <strong>To get your API key:</strong>
                            <ol>
                                <li>Go to <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a></li>
                                <li>Sign up or log in</li>
                                <li>Navigate to "API Keys"</li>
                                <li>Create and copy your key</li>
                            </ol>
                        </div>
                        <form autocomplete="off" onsubmit="return false;">
                        <div class="input-group">
                                <input type="text" 
                                       id="apiKey-anthropic" 
                                       placeholder="sk-ant-api03-..."
                                       autocomplete="off"
                                       data-form-type="other"
                                       data-lpignore="true"
                                       name="not-a-password"
                                       spellcheck="false"
                                       style="font-family: monospace; letter-spacing: 0.5px;">
                                <button class="btn-primary" onclick="window.saveApiKey('anthropic'); return false;" type="button">Save Key</button>
                        </div>
                        </form>
                    </div>

                    <!-- OpenAI Section -->
                    <div class="api-section provider-section" id="section-openai" style="display: none;">
                        <h3>OpenAI API</h3>
                        <div class="info-box">
                            <strong>To get your API key:</strong>
                            <ol>
                                <li>Go to <a href="https://platform.openai.com/" target="_blank">platform.openai.com</a></li>
                                <li>Sign up or log in</li>
                                <li>Navigate to "API Keys"</li>
                                <li>Create and copy your key</li>
                            </ol>
                        </div>
                        <form autocomplete="off" onsubmit="return false;">
                        <div class="input-group">
                                <input type="text" 
                                       id="apiKey-openai" 
                                       placeholder="sk-..."
                                       autocomplete="off"
                                       data-form-type="other"
                                       data-lpignore="true"
                                       name="not-a-password"
                                       spellcheck="false"
                                       style="font-family: monospace; letter-spacing: 0.5px;">
                                <button class="btn-primary" onclick="window.saveApiKey('openai'); return false;" type="button">Save Key</button>
                        </div>
                        </form>
                    </div>

                    <!-- Gemini Section -->
                    <div class="api-section provider-section" id="section-gemini" style="display: none;">
                        <h3>Google Gemini API</h3>
                        <div class="info-box">
                            <strong>To get your API key:</strong>
                            <ol>
                                <li>Go to <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
                                <li>Sign up or log in</li>
                                <li>Click "Create API Key"</li>
                                <li>Copy your key</li>
                            </ol>
                        </div>
                        <form autocomplete="off" onsubmit="return false;">
                        <div class="input-group">
                                <input type="text" 
                                       id="apiKey-gemini" 
                                       placeholder="AIza..."
                                       autocomplete="off"
                                       data-form-type="other"
                                       data-lpignore="true"
                                       name="not-a-password"
                                       spellcheck="false"
                                       style="font-family: monospace; letter-spacing: 0.5px;">
                                <button class="btn-primary" onclick="window.saveApiKey('gemini'); return false;" type="button">Save Key</button>
                        </div>
                        </form>
                    </div>

                    <!-- OpenRouter Section -->
                    <div class="api-section provider-section" id="section-openrouter" style="display: none;">
                        <h3>OpenRouter API</h3>
                        <div class="info-box">
                            <strong>To get your API key:</strong>
                            <ol>
                                <li>Go to <a href="https://openrouter.ai/" target="_blank">openrouter.ai</a></li>
                                <li>Sign up or log in</li>
                                <li>Navigate to "Keys"</li>
                                <li>Create and copy your key</li>
                            </ol>
                        </div>
                        <form autocomplete="off" onsubmit="return false;">
                        <div class="input-group">
                                <input type="text" 
                                       id="apiKey-openrouter" 
                                       placeholder="sk-or-..."
                                       autocomplete="off"
                                       data-form-type="other"
                                       data-lpignore="true"
                                       name="not-a-password"
                                       spellcheck="false"
                                       style="font-family: monospace; letter-spacing: 0.5px;">
                                <button class="btn-primary" onclick="window.saveApiKey('openrouter'); return false;" type="button">Save Key</button>
                        </div>
                        </form>
                    </div>
                    
                    <!-- Stability AI Section (for image generation) - HIDDEN BY DEFAULT -->
                    <div class="api-section provider-section" id="section-stability" style="display: none;">
                        <h3>Stability AI API (for Image Generation)</h3>
                        <div class="info-box">
                            <strong>To get your API key:</strong>
                            <ol>
                                <li>Go to <a href="https://platform.stability.ai/" target="_blank">platform.stability.ai</a></li>
                                <li>Sign up or log in</li>
                                <li>Navigate to "API Keys"</li>
                                <li>Create and copy your key</li>
                            </ol>
                            <p style="margin-top: 0.5rem; color: #666;">💡 <strong>Note:</strong> This key is only needed if you want to use Stability AI for image generation. It's separate from content generation.</p>
                        </div>
                        <form autocomplete="off" onsubmit="return false;">
                            <div class="input-group">
                                <input type="text" 
                                       id="apiKey-stability" 
                                       placeholder="sk-..."
                                       autocomplete="off"
                                       data-form-type="other"
                                       data-lpignore="true"
                                       name="not-a-password"
                                       spellcheck="false"
                                       style="font-family: monospace; letter-spacing: 0.5px;">
                                <button class="btn-primary" onclick="window.saveApiKey('stability'); return false;" type="button">Save Key</button>
                            </div>
                        </form>
                    </div>
                    </div>
                </div>
                
                <!-- AI Prompts Editor Tab -->
                <div id="promptsSettingsContent" style="display: none;">
                    <h3 style="margin-top: 1rem;">📝 AI Prompt Customization</h3>
                    <p class="prompts-description">Customize the AI prompts used for content generation, slide design, and file processing. All prompts are automatically backed up before changes.</p>
                    
                    <div id="promptEditorContainer">
                        <div class="prompts-cta">
                            <p style="text-align: center; color: #666;">Loading prompts...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer - Features & Guide Section -->
        <div class="footer">
            <div class="footer-content">
                <!-- Security Banner -->
                <div class="footer-security-banner">
                    <span class="security-icon">🔒</span>
                    <p>All processing on your server • Your API key stays local & secure</p>
    </div>

                <!-- Features Grid -->
                <div class="footer-section">
                    <h3 class="footer-section-title">✨ Powerful Features</h3>
                    
                    <!-- Vibrant Description -->
                    <div class="footer-description">
                        <p>
                            <strong>GENIS.AI</strong> is your ultimate AI-powered presentation creation platform that transforms ideas into stunning, professional presentations in seconds! 
                            Harness the power of cutting-edge AI models like Claude, GPT-5, Gemini, or our <strong>FREE Amazon Bedrock</strong> to generate beautiful slides with native charts, 
                            professional themes, live previews, and smart designs. Edit online, share instantly with unique links, auto-convert to PDF, and customize every detail—all while 
                            keeping your data secure on your own server. Whether you're crafting business pitches, educational content, or marketing presentations, GENIS.AI makes it effortless. 
                            <a href="https://aboutus.genis.ai" target="_blank" rel="noopener noreferrer" class="footer-link">Learn more about us →</a>
                    </p>
                </div>
                
                    <div class="footer-features-grid">
                        <div class="footer-feature-card">
                            <div class="feature-icon">🤖</div>
                            <strong>AI-Powered</strong>
                            <span>Claude, GPT-4, Gemini, or FREE Bedrock</span>
                    </div>
                        <div class="footer-feature-card">
                            <div class="feature-icon">📊</div>
                            <strong>Native Charts</strong>
                            <span>Bar, Pie, Line, Area - fully editable</span>
                    </div>
                        <div class="footer-feature-card">
                            <div class="feature-icon">🎨</div>
                            <strong>8+ Themes</strong>
                            <span>Professional color schemes</span>
                    </div>
                        <div class="footer-feature-card">
                            <div class="feature-icon">📄</div>
                            <strong>Auto PDF</strong>
                            <span>PPTX + PDF generated together</span>
                    </div>
                        <div class="footer-feature-card">
                            <div class="feature-icon">🔗</div>
                            <strong>Share Links</strong>
                            <span>One link, unlimited views</span>
                    </div>
                        <div class="footer-feature-card">
                            <div class="feature-icon">✏️</div>
                            <strong>Edit Online</strong>
                            <span>Modify slides in browser</span>
                    </div>
                        <div class="footer-feature-card">
                            <div class="feature-icon">👁️</div>
                            <strong>Live Preview</strong>
                            <span>See before you download</span>
                    </div>
                        <div class="footer-feature-card">
                            <div class="feature-icon">🎯</div>
                            <strong>Smart Design</strong>
                            <span>Decorative shapes & graphics</span>
                        </div>
                    </div>
                </div>
                
                <!-- API Options -->
                <div class="footer-section">
                    <h3 class="footer-section-title">🔑 Flexible API Options</h3>
                    <div class="footer-api-grid">
                        <div class="footer-api-card">
                            <div class="api-badge">Option 1</div>
                            <h4>Bring Your Own Key (BYOK)</h4>
                            <p>Use your own Anthropic, OpenAI, Google Gemini, or OpenRouter API key. You control costs and usage.</p>
                    </div>
                        <div class="footer-api-card footer-api-featured">
                            <div class="api-badge featured">💎 Option 2</div>
                            <h4>Use Our FREE Amazon Bedrock!</h4>
                            <p>Don't have an API key? No problem! We provide <strong>FREE unlimited access</strong> to Amazon Bedrock (Claude 3.5 Sonnet) - no credit card, no sign up, no catch!</p>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Start Guide -->
                <div class="footer-section">
                    <h3 class="footer-section-title">🎯 Quick Start Guide</h3>
                    <div class="footer-steps-grid">
                        <div class="step-card">
                            <div class="step-number">1</div>
                            <p>Enter your API key (or skip to use FREE Bedrock)</p>
                </div>
                        <div class="step-card">
                            <div class="step-number">2</div>
                            <p>Type your content or use AI Idea Generator</p>
                </div>
                        <div class="step-card">
                            <div class="step-number">3</div>
                            <p>Click "Generate Preview" to see slides</p>
            </div>
                        <div class="step-card">
                            <div class="step-number">4</div>
                            <p>Modify slides if needed with AI assistance</p>
                        </div>
                        <div class="step-card">
                            <div class="step-number">5</div>
                            <p>Click "Generate PowerPoint" to download</p>
                        </div>
                        <div class="step-card">
                            <div class="step-number">6</div>
                            <p>View online, share links, or download PDF!</p>
                        </div>
        </div>
    </div>

                <p class="footer-credits">Powered by Claude AI, html2pptx + PptxGenJS</p>
            </div>
        </div>
    </div>


    <!-- Load JavaScript Modules -->
    <!-- Core modules first -->
    <script src="/js/themes.js"></script>
    <script src="/js/charts.js"></script>
    <script src="/js/ui.js"></script>
    <script src="/js/preview.js"></script>
    <script src="/js/imageGallery.js"></script>
    
    <!-- API modules BEFORE api.js (important for function exports) -->
    <!-- Using fresh file name to avoid caching issues -->
    <script src="/js/api/capabilities.js"></script>
    <script src="/js/api/slidePreview.js"></script>
    <script src="/js/api/generation.js"></script>
    <script src="/js/api/viewer.js"></script>
    <script src="/js/api/sharing.js"></script>
    <script src="/js/api/modification.js"></script>
    
    <!-- App and utilities -->
    <script src="/js/app.js"></script>
    <script src="/js/fileHandler.js"></script>
    <script src="/js/skills.js"></script>
    <script src="/js/promptEditor.js"></script>
    
    <!-- API.js LAST (it checks if functions are loaded) -->
    <script src="/js/api.js"></script>
    
    <!-- Integration Diagnostics Script -->
    <script>
        // Run diagnostics on page load
        window.addEventListener('load', function() {
            console.log('═══════════════════════════════════════════════════');
            console.log('🔍 GENIS.AI - INTEGRATION DIAGNOSTICS');
            console.log('═══════════════════════════════════════════════════');
            console.log('');
            
            let allPassed = true;
            
            // Check all required functions
            const requiredFunctions = {
                'window.showStatus': window.showStatus,
                'window.generatePreview': window.generatePreview,
                'window.generateFromPrompt': window.generateFromPrompt,
                'window.generatePresentation': window.generatePresentation,
                'window.displayPreview': window.displayPreview,
                'window.getApiKey': window.getApiKey,
                'window.modifySlides': window.modifySlides,
                'window.loadExampleByCategory': window.loadExampleByCategory,
                'window.selectProvider': window.selectProvider,
                'window.saveApiKey': window.saveApiKey,
                'window.displayThemeSelector': window.displayThemeSelector,
                'window.selectTheme': window.selectTheme
            };
            
            console.log('📋 FUNCTION EXPORTS CHECK:');
            console.log('──────────────────────────');
            for (const [name, func] of Object.entries(requiredFunctions)) {
                const exists = typeof func === 'function';
                const status = exists ? '✅' : '❌';
                console.log(`${status} ${name}: ${typeof func}`);
                if (!exists) allPassed = false;
            }
            console.log('');
            
            // Check colorThemes
            console.log('🎨 THEMES CHECK:');
            console.log('──────────────────────────');
            if (window.colorThemes && typeof window.colorThemes === 'object') {
                const themeCount = Object.keys(window.colorThemes).length;
                console.log(`✅ window.colorThemes: ${themeCount} themes loaded`);
                console.log('   Themes:', Object.keys(window.colorThemes).join(', '));
            } else {
                console.log('❌ window.colorThemes: NOT LOADED');
                allPassed = false;
            }
            console.log('');
            
            // Check DOM elements
            console.log('📄 DOM ELEMENTS CHECK:');
            console.log('──────────────────────────');
            const requiredElements = [
                'textInput', 'ideaInput', 'previewBtn', 'promptBtn',
                'preview', 'status', 'themeSelector', 'numSlides',
                'generateImages', 'extractColors', 'useAsTemplate', 'fileUpload'
            ];
            
            for (const id of requiredElements) {
                const element = document.getElementById(id);
                const status = element ? '✅' : '❌';
                console.log(`${status} #${id}: ${element ? element.tagName : 'NOT FOUND'}`);
                if (!element) allPassed = false;
            }
            console.log('');
            
            // Check current provider
            console.log('⚙️  CONFIGURATION:');
            console.log('──────────────────────────');
            console.log(`   Current Provider: ${window.currentProvider || 'NOT SET'}`);
            console.log(`   Current View: ${window.currentView || 'NOT SET'}`);
            console.log('');
            
            // Final summary
            console.log('═══════════════════════════════════════════════════');
            if (allPassed) {
                console.log('✅ ALL CHECKS PASSED - Integration OK!');
                console.log('');
                console.log('🎯 Next steps:');
                console.log('   1. Set your API key in Advanced Configuration');
                console.log('   2. Try clicking "Generate Preview" button');
                console.log('   3. Try clicking "Expand Idea" button');
            } else {
                console.log('❌ SOME CHECKS FAILED - See errors above');
                console.log('');
                console.log('🔧 Troubleshooting:');
                console.log('   1. Hard refresh: Ctrl+Shift+F5');
                console.log('   2. Clear cache and reload');
                console.log('   3. Check browser console for errors');
            }
            console.log('═══════════════════════════════════════════════════');
            console.log('');
            
            // Add visual indicator to page
            if (allPassed) {
                console.log('💡 TIP: All systems operational! You can now use the app.');
            } else {
                console.log('⚠️  WARNING: Some systems not loaded properly!');
            }
        });
        
        // Test function for Generate Preview button
        window.testGeneratePreview = function() {
            console.log('🧪 Testing Generate Preview Button...');
            console.log('──────────────────────────────────────');
            
            if (typeof window.generatePreview !== 'function') {
                console.error('❌ window.generatePreview is NOT a function!');
                console.error('   Type:', typeof window.generatePreview);
                return;
            }
            console.log('✅ window.generatePreview exists');
            
            if (typeof window.showStatus !== 'function') {
                console.error('❌ window.showStatus is NOT defined!');
                return;
            }
            console.log('✅ window.showStatus exists');
            
            if (typeof window.getApiKey !== 'function') {
                console.error('❌ window.getApiKey is NOT defined!');
                return;
            }
            console.log('✅ window.getApiKey exists');
            
            const textInput = document.getElementById('textInput');
            const previewBtn = document.getElementById('previewBtn');
            
            if (!textInput) {
                console.error('❌ #textInput element NOT found!');
                return;
            }
            console.log('✅ #textInput element exists');
            
            if (!previewBtn) {
                console.error('❌ #previewBtn element NOT found!');
                return;
            }
            console.log('✅ #previewBtn element exists');
            
            console.log('');
            console.log('✅ All checks passed! Generate Preview should work!');
            console.log('   (Requires API key to actually generate)');
        };
        
        // Test function for Expand Idea button
        window.testExpandIdea = function() {
            console.log('🧪 Testing Expand Idea Button...');
            console.log('──────────────────────────────────────');
            
            if (typeof window.generateFromPrompt !== 'function') {
                console.error('❌ window.generateFromPrompt is NOT a function!');
                console.error('   Type:', typeof window.generateFromPrompt);
                return;
            }
            console.log('✅ window.generateFromPrompt exists');
            
            if (typeof window.showStatus !== 'function') {
                console.error('❌ window.showStatus is NOT defined!');
                return;
            }
            console.log('✅ window.showStatus exists');
            
            if (typeof window.getApiKey !== 'function') {
                console.error('❌ window.getApiKey is NOT defined!');
                return;
            }
            console.log('✅ window.getApiKey exists');
            
            const ideaInput = document.getElementById('ideaInput');
            const promptBtn = document.getElementById('promptBtn');
            
            if (!ideaInput) {
                console.error('❌ #ideaInput element NOT found!');
                return;
            }
            console.log('✅ #ideaInput element exists');
            
            if (!promptBtn) {
                console.error('❌ #promptBtn element NOT found!');
                return;
            }
            console.log('✅ #promptBtn element exists');
            
            console.log('');
            console.log('✅ All checks passed! Expand Idea should work!');
            console.log('   (Requires API key to actually generate)');
        };
        
        // Add keyboard shortcut for quick test
        document.addEventListener('keydown', function(e) {
            // Ctrl+Shift+D for diagnostics
            if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                e.preventDefault();
                console.clear();
                window.location.reload();
            }
            // Ctrl+Shift+T for test
            if (e.ctrlKey && e.shiftKey && e.key === 'T') {
                e.preventDefault();
                console.log('');
                testGeneratePreview();
                console.log('');
                testExpandIdea();
            }
        });
    </script>
    
    <!-- GitHub Buttons Script -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
</body>
</html>

